import { readWordContent } from '../src/utils/document-loader/WordLoader';
import { join } from 'path';
import { writeFile } from 'fs/promises';

async function optimizeDocument(fileName: string) {
  const filePath = join(process.cwd(), fileName);
  const content = await readWordContent(filePath);
  
  // 优化后的格式化内容
  const optimized = `
═══════════════════════════════════════════════════════════════════════════════

                关于《解除劳动合同通知书》的
              异议声明及要求安排任务、支付工资的函

═══════════════════════════════════════════════════════════════════════════════

【函件编号】WS-20251223-001

【致】凯美瑞德（苏州）信息科技股份有限公司深圳分公司 HR 部门

【发函人】魏爽
【身份证号】411381199901146748
【联系电话】[你的手机号码]
【日期】2025 年 12 月 23 日

───────────────────────────────────────────────────────────────────────────────

【函件正文】

    贵司 2025 年 12 月 22 日发送的《解除劳动合同通知书》已收悉。本人对贵司单方
解除劳动合同的行为及所列理由均坚决否认；同时，本人于 2025 年 12 月 23 日正常到
岗出勤，但未收到任何工作任务安排。现结合事实与法律郑重声明并函告如下：

───────────────────────────────────────────────────────────────────────────────

一、坚决反对贵司单方解除劳动合同，该行为构成违法解除

    本人与贵司签订了期限为 0.5 年的劳动合同（2025 年 8 月 6 日至 2026 年 2 月 
5 日），劳动合同履行期间，本人始终恪守岗位职责、完成工作任务，不存在任何符合
《劳动合同法》第 39 条规定的"严重违反规章制度"情形。

    贵司在未与本人协商、未提供合法有效证据的情况下，单方作出解除劳动合同的决
定，严重侵犯了本人的合法劳动权益，属于违法解除。

───────────────────────────────────────────────────────────────────────────────

二、所谓"不遵守考勤纪律"无任何事实依据，贵司需依法举证

（一）公司明确约定弹性打卡，本人考勤符合标准

    入职后，贵司已向部门所有员工明确告知实行"弹性上班打卡"制度，本人自始至
终严格按照该约定履行出勤义务。前 4 个月与后续考勤模式完全一致，贵司均按全额工
资足额发放薪酬，从未就考勤问题提出过任何异议，足以证明本人考勤符合公司管理标
准。

（二）贵司主张考勤违规，需提供完整合法证据

    依据"谁主张、谁举证"的法律原则，若贵司坚持认为本人存在考勤违规，需在收
到本函后 3 个工作日内，提供以下具体证据（口头陈述、模糊记录均无效）：

    1. 每一次考勤违规的精确日期、具体时长、原始考勤数据（如考勤系统后台原始截
       图、打卡设备生成的时间戳记录、本人签字确认的纸质考勤表等）；

    2. 该违规行为对应的《员工手册》或考勤制度具体条款（需明确条款编号及原文，
       且证明该制度已依法告知本人）；

    3. 排除"弹性打卡"适用的合法依据（需证明本人所谓"违规"不属于弹性打卡允
       许的合理范围）。

（三）本人加班记录印证工作合规性

    工作日期间，本人多次存在晚上加班的情况，相关加班记录（如 git 代码提交记录、
工作沟通记录等）均可佐证本人积极履行工作义务，不存在"不遵守考勤纪律"进而影
响工作的情形。

───────────────────────────────────────────────────────────────────────────────

三、"经多次提醒未改善"纯属虚构，系对本人工作成果的否定

    贵司在通知书中声称"经多次提醒未改善"，完全与事实不符：

    1. 截至收到解除通知之日，本人从未收到过贵司任何关于考勤违规的书面提醒、警
       告函、整改通知等正式文件；

    2. 所谓"提醒"若为口头形式（包括微信口头提及、会议口头告知），均无具体违
       规事实指向、无明确整改要求、无制度后果告知，且未形成"多次"（至少 2 次
       及以上）的有效记录。

    本人在职期间，始终认真完成各项工作任务，加班加点推进项目，工作成果获得同
事认可。贵司以虚构的"多次提醒未改善"为由解除合同，实质是对本人工作成果的无
端否定，严重损害本人职业声誉。

───────────────────────────────────────────────────────────────────────────────

四、本人不存在"严重违反公司规章制度"的情形

    贵司主张本人"严重违反公司规章制度"，但未明确具体违反的制度条款、具体事
实及法律依据。如前所述，本人考勤符合"弹性打卡"约定，无有效证据证明存在违规；
工作中无任何迟到、早退、旷工、消极怠工等违反规章制度的行为，更不存在"严重违
反"的情形。

    贵司该主张无任何事实支撑，不能作为解除劳动合同的合法依据。

───────────────────────────────────────────────────────────────────────────────

五、要求贵司立即安排工作任务并明确工资支付标准

    本人于 2025 年 12 月 23 日按正常工作时间到岗出勤（附打卡记录/工位待命照片
为证），但截至发函时未收到贵司任何形式的工作任务安排。依据《劳动合同法》第 29 
条"用人单位与劳动者应当按照劳动合同的约定，全面履行各自的义务"，现提出以下
要求：

    1. 请贵司在收到本函后 1 个工作日内，通过书面形式（邮件/纸质通知）向本人分
       配与岗位职责相符的具体工作任务（如项目开发、文档撰写、系统维护等）；

    2. 若贵司短期内确实无工作任务可安排，需与本人协商一致并签订书面《待岗协议》，
       明确待岗期间工资标准（不低于劳动合同约定的 13,000 元/月）、待岗期限及恢
       复工作的条件；

    3. 自 2025 年 12 月 23 日起，无论是否安排工作任务，贵司需按本人原工资标准
       （13,000 元/月）足额支付工资，不得克扣、拖欠或降低标准，上述工资与 2025 
       年 12 月正常工资一并发放。

───────────────────────────────────────────────────────────────────────────────

六、本人合法诉求及沟通意愿说明

    为妥善解决争议，本人本着平等协商的原则，现明确以下诉求及沟通前提：

（一）举证要求

    请贵司在收到本函后 3 个工作日内，就《解除劳动合同通知书》所列"不遵守考勤
纪律、经多次提醒未改善"的主张，提供完整合法的证据（具体包括：每一次考勤违规
的精确日期、时长、原始考勤数据，对应的制度条款及告知凭证，多次提醒的书面记录
等）。

（二）撤销解除通知

    若贵司无法提供有效证据，请立即撤销 2025 年 12 月 22 日作出的《解除劳动合同
通知书》，恢复双方劳动关系并继续履行原劳动合同。

（三）经济补偿要求

    若双方协商后未能恢复劳动关系，或贵司仍坚持解除，请在 3 个工作日内足额支付
以下款项：

    1. 违法解除劳动合同赔偿金：13,000 元
       （计算方式：2N，N = 0.5 个月 × 13,000 元/月）

    2. 未休年假工资：597.69 元
       （计算方式：1 天 × 13,000 元 ÷ 21.75 天）

    3. 未休调休假工资：597.69 元
       （计算方式：1 天 × 13,000 元 ÷ 21.75 天）

（四）离职证明要求

    无论争议最终如何解决，请贵司在 15 日内出具符合《劳动合同法实施条例》第 24 
条规定的离职证明（仅载明劳动合同期限、工作岗位、离职日期，不得添加任何主观负
面评价），以免影响本人后续职业发展。

───────────────────────────────────────────────────────────────────────────────

【结语】

    本人始终愿意与贵司通过友好协商的方式化解分歧，上述诉求均基于合法合规及公
平合理原则提出。

    若贵司未在上述期限内：
    • 回应举证要求
    • 安排工作任务
    • 明确工资支付承诺
    • 就争议解决方案与本人达成一致

    本人将通过以下合法途径维护自身权益：
    • 向深圳市劳动人事争议仲裁委员会申请仲裁
    • 向劳动监察部门投诉
    • 主张赔偿金、拖欠工资、未休假期工资及逾期支付的加付赔偿金

    请贵司予以重视并积极配合。

───────────────────────────────────────────────────────────────────────────────

【附件清单】

    1. 2025 年 12 月 23 日到岗打卡截图/工位待命照片（复印件）
    2. 本人加班记录截图（git 代码提交记录等，复印件）
    3. 前 4 个月工资流水截图（复印件）
    4. 本人身份证复印件（签字按手印）

───────────────────────────────────────────────────────────────────────────────

函件人（手写签名）：__________________

日期（手写）：2025 年 12 月 23 日

═══════════════════════════════════════════════════════════════════════════════
`;

  return optimized;
}

async function main() {
  const fileName = '魏爽-关于《解除劳动合同通知书》的异议声明及要求安排任务、支付工资的函.docx';
  
  console.log('📝 正在优化文档格式...\n');
  
  const optimized = await optimizeDocument(fileName);
  
  // 保存为文本文件
  const outputPath = join(process.cwd(), '优化后的函件.txt');
  await writeFile(outputPath, optimized, 'utf-8');
  
  console.log('✅ 优化完成！');
  console.log(`📄 已保存到: 优化后的函件.txt\n`);
  console.log('主要优化内容：');
  console.log('  ✓ 添加了清晰的标题和分隔线');
  console.log('  ✓ 规范了函件头部信息格式');
  console.log('  ✓ 优化了段落层次和缩进');
  console.log('  ✓ 统一了数字和金额格式（添加千位分隔符）');
  console.log('  ✓ 改进了列表和要点的排版');
  console.log('  ✓ 增强了视觉层次感和可读性');
  console.log('  ✓ 规范了法律条款引用格式');
  console.log('\n💡 建议：将此文本内容复制到 Word 中，使用等宽字体（如 Consolas 或 Courier New）以保持对齐效果。');
}

main();
